---
title: "Assignment 2"
author: "Geraldo B. Padilla F, Mubarak Mojoyinola"
date: "22-02-2022"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(fig.width = 8, fig.height = 8, results = 'hold', fig.align = 'center')
knitr::opts_chunk$set(fig.width = 10, fig.height = 8)
```


```{r packages, message=FALSE, echo=FALSE}
library(dplyr)
library(ggplot2)
library(tidyverse)
library(fivethirtyeight)
theme_set(theme_bw(base_size = 14))
d1 = data.frame(college_recent_grads)
attach(d1)
```

# Question 1
Which majors are the most popular?

```{r most.pop.majors}
knitr::kable(
  head(d1%>%
         arrange(desc(total))%>%
         select(major, total),
       5),
  'pipe',
  caption = 'Table 1: 5 Most Popular Majors',
  format.args = list(big.mark = ','),
  col.names = c('Major', 'Total'))
```

# Question 2
Which majors are the least popular?
```{r least.pop.majors}
knitr::kable(
  head(d1%>%
         arrange(total)%>%
         select(major, total),
       5),
  caption = 'Table 2: 5 Least Popular Majors',
  col.names = c('Major', 'Total'),
  format.args = list(big.mark = ','),
  'pipe'
)
```

# Question 3
Explore the distribution of the variable/attribute sharewomen visually. Summarize characteristics of this variable in a few sentences. Be sure to include any figure(s) or statistics as evidence to support your description.
```{r Q3}
summary(d1$sharewomen)

```


```{r, warning=FALSE}
theme_set(theme_bw())
ggplot(d1, aes(x = sharewomen))+
  geom_density(fill = "gray")+
  labs(title = "Density Plot of Share of Women in Major", x = "Proportion of Women",
       y = "Density")

```

On average, the majors have 52.2% female graduates (`sharewomen`). The minimum proportion  female major cartegory is 0% (Military Technology) while the  major with the maximum proportion of female has 96.9% (Early Childhood Education).

Graph 1 shows the density distribution of this variable. As can be seen, most majors have approximately 30% to 75% female graduates. The distribution is slightly skewed to the left (negative skewness).


# Question 4
Which major categories are the most unisex and which major categories are the most disproportionate?

Table 3 shows the Major categories with the highest female presence. In first place is Health, with 387,371 female graduates, equivalent to 83.7% of the total number of graduates in this area. In second place is Education, with 81.5%.
```{r major.women}
knitr::kable(
  head(
    d1%>%
      na.omit()%>%
      group_by(major_category)%>%
      summarise(
        tot_grads = sum(total),
        tot_women = sum(women),
        prop_women = tot_women/tot_grads)%>%
      arrange(desc(prop_women)),
  5),
  caption = 'Table 3: Top 5 Majors Prefered by Women',
  col.names = c('Major category', 'Total Graduates', 'Total Women','Prop. Women'),
  'pipe',
  format.args = list(big.mark = ',', digits = 3),
)
```

Table 4 shows the Major categories with the highest male presence. The first place is occupied by Engineering, with 408,307 male graduates, which is equivalent to 76% of the total number of graduates. This category is followed by Computer Science and Mathematics, with 69.8% male participation.

```{r major.men}
knitr::kable(
  head(
    d1%>%
      na.omit()%>%
      group_by(major_category)%>%
      summarise(
        tot_grads = sum(total),
        tot_men = sum(men),
        prop_men = tot_men/tot_grads)%>%
      arrange(desc(prop_men)),
  5),
  caption = 'Table 4: Top 5 Majors Prefered by Men',
  col.names = c('Major category', 'Total Graduates', 'Total Men','Prop. Men'),
  'pipe',
  format.args = list(big.mark = ',', digits = 3),
)
```
Table 5 shows major with approximately the same number of men and women.

```{r major.uni}
knitr::kable(
  head(
    d1%>%
      na.omit()%>%
      group_by(major_category)%>%
      summarise(
        tot_grads = sum(total),
        tot_men = sum(men),
        prop_men = tot_men/tot_grads)%>%
      filter(between(round(prop_men, digits = 2),0.49,0.51))%>%
      arrange(prop_men),
  5),
  caption = 'Table 5: Top 3 Unisex Majors',
  col.names = c('Major category', 'Total Graduates', 'Total Men','Prop. Men'),
  'pipe',
  format.args = list(big.mark = ',', digits = 3),
)
```

As can be inferred from the three tables above, the most disproportionate Major categories are Health and Engineering while Law & Public Policy is the most unisex major.

# Question 5
Create a figure that effectively shows which major categories are the most unisex and disproportionate in a single figure. Discuss briefly why this figure is effective at answering research question 2 and 3.

```{r Q5a}
share_women <- d1%>%drop_na()%>%select(major_category, men, women, total)%>%group_by(major_category)%>%summarise(Male= sum(men), Female = sum(women), Tot
                                       = Male+Female, Prop_female = Female/Tot)%>%arrange(desc(Prop_female))


```

```{r Q5}
ggplot(share_women, aes(y = reorder(major_category, -Prop_female), x = Prop_female, xlim(0,1)))+
  geom_bar(stat ="identity")+
  scale_x_continuous(labels = scales::comma)+
  labs(x = "Proportion of Female in Major Category", y = "Major category", title = "Proportion of Females by Major Category ")+
  geom_vline(xintercept = 0.5, color = "Red", size = 1)
```

The chart above shows the proportion of females in each major category. The red vertical line indicates when the proportion is `0.5`, that is the point where the major category has equal number of males and females. In this single figure, we can deduce a major that is male disproportionate based on how far behind the top of the bar is from the vertical line and a major is female disproportionate from how far away the top of the bar is from the vertical line.

Engineering is the most male disproportionate major category, Health is the most female disproportionate major category while Law and Public Policy is the most unisex major category.


# Question 6
Create a figure that explores if there is a relationship between the popularity of a major and the unemployment rate. Discuss briefly how you defined popularity and why this figure helps to show the relationship between the two attributes. Be sure in your discussion to also state your interpretation of the figure. 

```{r Q6, warning=FALSE}
ggplot(d1)+
  geom_point(aes(x = unemployment_rate, y = total))+
  scale_y_continuous(labels = scales::comma)+
  labs(x = "Unemployment Rate", y = "Major Populariyy (Based on Total Graduate)", title = "Relationship Between Popularity of Major and Unemployment Rate")
```

The popularity of a major is defined by the total number of graduate the major produced. The figure allows having one variable on the horizontal axis and the other variable on the vertical axis, thereby making it possible to map the position of a combination of the two variables on the plot. The figure shows that there is no relationship between major popularity and unemployment rate.

# Question7
Building off of #6, create a figure that explores if there is a relationship between the popularity of a major and the median salary (shown with the median attribute). Discuss how you defined popularity and why this figure helps to show the relationship between the two attributes. Be sure in your discussion to also state your interpretation of the figure. 

```{r Q7, warning=FALSE}
ggplot(d1)+
  geom_point(aes(x = median, y = total))+
  scale_y_continuous(labels = scales::comma)+
  scale_x_continuous(labels = scales::comma)+
  labs(x = "Median Salary", y = "Major Populariyy (Based on Total Graduate)", title = "Relationship Between Popularity of Major and Median Salary")
```

The popularity of a major is defined by the total number of graduate the major produced. The figure allows having one variable on the horizontal axis and the other variable on the vertical axis, thereby making it possible to map the position of a combination of the two variables on the plot. The figure shows that there is no relationship between major popularity and median salary.

# Question8
Create a figure that explores if there is a relationship between the popularity of a major category and the unemployment rate. Discuss why this figure helps to show the relationship between the two attributes and also discuss how this figure may differ from the one created in #6. What additional features did you need to consider to make an effective visualization of this relationship given the data structure. Be sure in your discussion to also state your interpretation of the figure. Note, you may wish to use dplyr and ggplot2 to help with this question. 1 pt

```{r Q8}
employment <- d1%>%
  drop_na()%>%
  select(major_category, employed, unemployed, total)%>%
  group_by(major_category)%>%
  summarise(
  Employed_new= sum(employed), 
  Unemployed_new = sum(unemployed), 
  Total_new = Employed_new+Unemployed_new,                                     
  unemployment_rate_new = Unemployed_new/Total_new, em_total = sum(total))

```

```{r Q}
ggplot(employment)+
  geom_point(aes(x = unemployment_rate_new, y = em_total))+
  scale_y_continuous(labels = scales::comma)+
  scale_x_continuous(labels = scales::comma)+
  labs(x = "Unemployment Rate", y = "Major Category Populariyy (Based on Total Graduate)", title = "Relationship Between Popularity of Major Category and Unemployment Rate")
```

The figure allows having one variable on the horizontal axis and the other variable on the vertical axis, thereby making it possible to map the position of a combination of the two variables on the plot. In #6 as we were exploring the relationship between the individual majors and unemployment rate but now, we are aggregating the majors by category in order to get a general picture of the relationship between these variables. We had to calculate the population for each major category and also the unemployment rate by major categories.  The figure shows that the relationship between major popularity and unemployment rate is weak.


# Question 9
Create a figure that explores if there is a relationship between the popularity of a major category and the median salary (shown with the median attribute). Discuss why this figure helps to show the relationship between the two attributes and also discuss how this figure may differ from the one created in #6. What additional features did you need to consider to make an effective visualization of this relationship given the data structure. Be sure in your discussion to also state your interpretation of the figure. Note, you may wish to use dplyr and ggplot2 to help with this question. 1 pt

```{r}
d1%>%drop_na()%>%
  group_by(major_category)%>%
  summarise(
    salary_md = median(sum(median)),
    pop_major = sum(total)
  )%>%
  ggplot(.)+
  geom_point(aes(x = salary_md, y = pop_major))+
  scale_y_continuous(labels = scales::comma)+
  labs(x = "Median Salary", y = "Major Category Popularity (Based on Total Graduate)", title = "Relationship Between Popularity of Major Category and Median Salary")
  

```

The figure allows having one variable on the horizontal axis and the other variable on the vertical axis, thereby making it possible to map the position of a combination of the two variables on the plot. In #7 as we were exploring the relationship between the individual majors and median salary but now, we are aggregating the majors by category in order to get a general picture of the relationship between these variables. We had to calculate the population for each major category and also the median of the median salary by major categories.  The figure shows that the relationship between major popularity and median salary slightly positive.


# Question 10
Identify a new research question from the college_recent_grads that interests you. State this research question, then create a figure that highlights/explores the research question. Discuss briefly why this figure does a good job of exploring the research question. What challenges did you have creating the figure? 1 pt

```{r}
d1%>%drop_na()%>%
  group_by(major_category)%>%
  summarise(
    pop_college =sum(college_jobs),
    pop_employed = sum(employed),
    prop_college = pop_college/pop_employed
  )%>%
  ggplot(.)+
  geom_bar(aes(y = reorder(major_category, -prop_college), x = prop_college),stat ="identity")+
  scale_x_continuous(labels = scales::comma)+
  labs(x = "Proportion of Employment That Require a College Degree", y = "Major Category", title = "Proportion of Employment That Require a College Degree by Major Category ")

```

We want to explore the major categories where graduates are getting jobs that require a college degree.
This figure is useful for exploring our research question because it shows the proportion of graduate students who, while employed, needed a college degree to get the job. Based on the figure above we can answer our research question and infer that graduates with a degree in education need a college degree in order to get a job. In contrast, graduates with business degrees are not required to have a college degree to get a job. The only challenge we had was to pay attention for grouping variable to estimate the final outcome.

